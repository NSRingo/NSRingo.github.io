import { Steps, ModuleInstall } from "@theme";
import _Footer from "./_Footer.md";

# 📺 TV

:::warning ⚠️

不支持 🇨🇳 中国大陆 的 App Store 账号

:::

## 简介
* 自定义TV app，自选启用的板块、栏目及语言。

## 解锁步骤
* 如启用本模块后重新打开`Apple TV`未见生效，可按照下列步骤激活:
    <Steps>
      ### 第 1 步
      启用[`📺 TV`](./apple-tv)模块
      打开`TV`app (app又名: `TV`或`视频`)

      ### 第 2 步
      观察是否存在下列特征:
      * iOS/iPadOS: 
        * iOS 17.2 前:
          * 观察`立即观看`页面是否有`儿童`一个二级入口
          * 观察标签栏是否为`立即观看`、`原创内容`、`商店`、`体育节目`、`资料库`五个标签页
        * iOS 17.2 后:
          * `立即观看`被`主页`代替，顶端采用动态展示栏，此特征失效
          * 标签栏固定为`主页`、`原创内容(Apple TV+)`、`商店`、`资料库`、`搜索`五个标签页，此特征失效
      * macOS/tvOS: 查看标签栏是否有`立即观看`、`tv+`、`商店`、`体育节目`、`儿童`、`资料库`六个标签页按钮
      > 此项目的目的是为了解锁其他地区地区账号的功能，不建议美区账号用户使用  
      > 如您的账号已经是美区账号，则可能启用前后并无差异  

      ### 第 3 步
      如不存在上述特征，可尝试以下操作强制刷新配置文件:
      打开`TV app`(`TV`或`视频`)
      点击右上角头像
      点击`退出登录`
      重新输入`Apple ID`与`密码`登入
      > 此时应在`Surge`的`最近请求`或`Quantumult X`的`网络活动`中观察到:  
      > `TV app`的`https://uts-api.itunes.apple.com/uts/v3/configitions`链接  

      ### 第 4 步
      如没有请冷启动一次`TV`app (app又名: `TV`或`视频`)
    </Steps>

## 配置方法
* 基础: 直接使用
  * 采用[默认配置](#默认设置)
* 进阶: 配合`Loon`设置面板或`Surge`参数设置功能进行个性化设置
  * 提供一定的自定义设置，如内置规则的`分流策略`选择、`国家或地区代码`选择等
* 高级: 配合`BoxJs`及订阅使用
  <details>
  <summary>ℹ️ 用前须知：使用`BoxJs`进行配置将被视为专业用户，官方不受理因使用`BoxJs`配置导致的各种问题</summary>

  1. 安装`BoxJs`插件并更新引用资源或脚本:
     * 安装方法及下载链接详见: [🧰 BoxJs](./box-js)
  2. 在`BoxJs`的配置面板中进行个性化设置:
    1. 浏览器访问[BoxJs.com](http://boxjs.com)
    2. 在[`应用`](http://boxjs.com/#/app)页面点开` iRingo`折叠
    3. 在[`📺 TV`](http://boxjs.com/#/app/iRingo.TV)根据需要填写您的设置信息
  </details>

## 功能列表
* 混合区域支持
  * 默认混合账号所在区(`立即观看`、`电影`)，新加坡(`tv+`、`原创内容`、`搜索`、`人物`)，美国(`电视节目`、`体育节目`、`儿童`)三个地区的内容
    * 港澳台地区账号，拥有tv+订阅的，可以收看美区tv+的`体育节目`直播内容（如最新内置的MLB联赛直播）
    * 转区的账号，可以通过修改`影片详情页`观看之前所在地区购买的电影等内容（如A区购买的电影，在B区未上架）
    * 语言和字幕有地区限制的内容，可以通过修改`影片详情页`观看中文字幕的版本（如某账号在美区购买电影无中字，但是同ID的影片在港澳台地区提供中字，可以通过将`影片详情页`改为港澳台后播放获得中文字幕）
* 多语言支持
  * 底部标签栏与栏目入口语言自适应（目前仅适配`简体中文`、`繁体中文`、`英语`，如需更多语言适配请PR或提供翻译文本）
  * 影片详情页语言自动回退
    * 可自定义语言优先级，默认顺序为`简体中文（新加坡）` => `繁体中文（台湾）` => `英语（美国）`
* 解除客户端平台限制
  * 为macOS、Android TV、Web版`TV app`启用第三方供应商(如: Disney+,Prime Video等)影片库和服务集成
* 硬件及平台
  - [x] macOS
  - [x] iPad
  - [x] iPhone
  - [x] Apple TV (需Surge for macOS的`网关模式`或Loon的`代理服务器`等) 
  - [ ] Android TV (需Surge for macOS的`网关模式`或Loon的`代理服务器`等) (Android TV效果待测试，不确定是否可用)
  - [ ] Web(待测试，不确定是否可用)
* 分类页面
  - [x] 立即观看
  - [x] TV+（iOS/iPadOS版客户端为`原创内容`）
  - [x] 商店 (`电影`、`电视节目`为`商店`二级菜单)
  - [x] 体育节目 (macOS版客户端无关注「喜爱的球队」功能和显示比分功能)
  - [x] 儿童 (iOS版客户端为`立即观看`二级菜单)
  - [x] 资料库
  - [x] 搜索

## 安装链接

<ModuleInstall urlPrefix="https://github.com/NSRingo/TV/releases/latest/download/">
  <ModuleInstall.Tab type="loon">
    <ModuleInstall.Item
      url="iRingo.TV.plugin"
      badge={[
        {
          type: "tip",
          text: "MitM",
          outline: true,
        },
        {
          type: "info",
          text: "脚本",
          outline: true,
        },
      ]}
    />
  </ModuleInstall.Tab>
  <ModuleInstall.Tab type="surge">
    <ModuleInstall.Item
      url="iRingo.TV.sgmodule"
      badge={[
        {
          type: "danger",
          text: "MitM",
          outline: true,
        },
        {
          type: "warning",
          text: "脚本",
          outline: true,
        },
      ]}
    />
  </ModuleInstall.Tab>
  <ModuleInstall.Tab type="stash">
    <ModuleInstall.Item
      url="iRingo.TV.stoverride"
      badge={[
        {
          type: "info",
          text: "覆写",
          outline: true,
        },
        {
          type: "info",
          text: "MitM",
          outline: true,
        },
        {
          type: "info",
          text: "脚本",
          outline: true,
        },
      ]}
    />
  </ModuleInstall.Tab>
  <ModuleInstall.Tab type="egern">
    <ModuleInstall.Item
      url="iRingo.TV.yaml"
    />
  </ModuleInstall.Tab>
  <ModuleInstall.Tab type="qx">
    <ModuleInstall.Item
      url="iRingo.TV.snippet"
      badge={[
        {
          type: "danger",
          text: "重写",
          outline: true,
        },
        {
          type: "tip",
          text: "MitM",
          outline: true,
        },
      ]}
    />
  </ModuleInstall.Tab>
  <ModuleInstall.Tab type="shadowrocket">
    <ModuleInstall.Item
      url="iRingo.TV.srmodule"
      badge={[
        {
          type: "tip",
          text: "HTTPS 解密",
          outline: true,
        },
      ]}
    />
  </ModuleInstall.Tab>
</ModuleInstall>

## 更新日志
* v3.0.0
  * 优化与修复
    1. 重构代码
    2. 修复bug
* v2.1.0-request
  * 优化与修复
    1. 优化域名匹配方法，精简逻辑和代码量
* v2.0.8-request
  * 优化与修复
    1. 补充`搜索`页面匹配规则
    2. 补充`其他`页面匹配规则
    3. 补充`原创内容`页面匹配规则
    4. 修复`语言代码`数据库
* v2.0.7-request
  * 优化与修复
    1. 补充`频道`页面匹配规则
    2. 更新`标签页`标题数据库
    3. 更新`模块`匹配规则和图标
    4. 补充`其他`页面匹配规则
* v2.0.3-response
  * 更新功能
    1. 新增`标签栏`与`板块入口`按钮语言自适应更改功能
* v2.0.6-request
  * 优化与修复
    1. 增加`语言代码`数据库
    2. 增加`语言代码`改写功能
    3. 补充`影片详情`页面匹配规则
* v2.0.5-request
  * 优化与修复
    1. 补充`原创内容`页面匹配规则
    2. 补充`体育节目`页面匹配规则
    3. 新增`搜索`页面匹配规则
    4. 新增`待播清单`页面匹配规则
    5. 补充`频道`页面匹配规则
* v2.0.4-request
  * 优化与修复
    1. 修复`地区代码`的`自动`选项
    2. 修复`待播清单`页面匹配规则
    3. 补充`喜爱`功能匹配规则
    4. 补充`人物`页面匹配规则
    5. 补充`其他`页面匹配规则
* v2.0.3-request
  * 优化与修复
    1. 新增`商店代码`数据库
    2. 新增`商店代码`修改功能
* v2.0.1
  * 更新功能
    1. 新增BoxJs面板支持，可以精确控制`TV app`功能
    2. 增加开启第三方影片库功能
    3. 增加自定义板块与栏目入口功能
    4. 增加自定义每个板块与栏目地区功能
    5. 其他新增设置项，详见BoxJs设置面板
  * 优化与修复
    1. 采用全新的环境变量设置(setENV)功能来存储设置、缓存和配置
    2. 支持全新的argument配置方法，支持深路径配置写入
    3. 采用`请求`与`回复`脚本分离的设计方式，缩短运行时间

<_Footer />
